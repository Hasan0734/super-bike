!function(e){var r={initShareDeliveries:function(t,a){var n,o=t,i=null,l=null,u=null,a=a||{},s=null,c=new r.socialShareHelpers,d={gaqCategory:a.gaqCategory||"",gaqAction:a.gaqAction||"",onInit:a.onInit||e.noop,onShare:a.onShare||e.noop},h=function(){d.onInit(Fiverr),f()},f=function(){"undefined"!=typeof fSocialSDK&&fSocialSDK.use(["facebook","google","linkedin"]),e.each(o,function(e,r){v(r)}),g()},p=function(){var r=e(".js-short-share-url"),t=r.parent(),a=e(".js-short-share-link");r.length&&(r.val("http://share.fiverr.com/..."),r.on("click",function(){Fiverr.pushGoogleTag("order-page-delivery","social","copy-link"),r.val("").addClass("disabled").unbind(),t.addClass("loading"),i=y(e(this)),S(i,function(n){r.val(n).removeClass("disabled").select(),t.removeClass("loading"),a.attr("href",n).append(e(".ficon-link")).removeClass("hidden")}),d.onShare(Fiverr,this),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent",d.gaqCategory,d.gaqAction,"copy link"]),e(".js-popup-order-social-share").trigger("js-tracking-share-short-url")}))},g=function(){var r=e(".fbsend");return r.length<1?!1:void r.bind("click",function(r){var t="",a=y(e(this));S(a,function(e){t=e},"false"),FB.ui({method:"send",name:e.t("deliveries.share.fb_share",{delivery_type:a.delivery_type}),link:t,display:"popup"}),_("fbsend,"+d.gaqAction),d.onShare(Fiverr,this),r.preventDefault()})},v=function(r){if(!r)return!1;var t=e(r).attr("social_platform");"email"!==t&&e(r).on("click",function(a){S(y(e(this)),function(a){a&&c[t](e(r),{urlToShare:a})},"false"),d.onShare(Fiverr,this),_(i.social_platform+","+d.gaqAction),a.preventDefault()})},_=function(e){"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent",d.gaqCategory,d.gaqAction,e])},y=function(e){var r=l||e.attr("object_id"),t=u||e.attr("delivery_type");if(!r||"undefined"==typeof r)throw"no object to share";if(!t||"undefined"==typeof t)throw"no delivery type";return i={object_id:r,object_type:e.attr("object_type"),gig_id:e.attr("gig_id"),order_id:e.attr("order_id"),delivery_id:e.attr("delivery_id"),user_id:e.attr("user_id"),social_platform:e.attr("social_platform"),sharer:e.attr("sharer"),delivery_type:t,source:e.attr("source"),share_url:e.attr("share_url"),share_utm_source:e.attr("utm_source"),share_utm_term:e.attr("utm_term"),share_utm_campaign:e.attr("utm_campaign"),share_utm_medium:e.attr("utm_medium"),buyable_type:e.attr("buyable_type")}},S=function(r,t,a){e.ajax({type:"get",url:"/d/share_delivery",data:r,dataType:"text",async:"false"==a?!1:!0,success:function(e){t(e)},error:function(){n&&n.close()}})};Fiverr.setShareParams=function(e,r){l=e,u=r,p(),s=null},h()},socialShareHelpers:function(){var e=this;e.fb=function(e,r,t){r=r||{},t=t||{},"undefined"!=typeof FB&&e&&FB.ui({method:"share",href:r.urlToShare||e.attr("href")},function(e){t.onShareClickCallback?t.onShareClickCallback(e):e&&Fiverr.sendSharingToDoCompleted()})},e.tw=function(e,r,t){r=r||{},t=t||{},"undefined"!=typeof twttr&&e&&(r.urlToShare&&e.attr("href",r.urlToShare),twttr.events&&twttr.events.bind("tweet",function(e){t.onShareClickCallback?t.onShareClickCallback(e):Fiverr.sendSharingToDoCompleted()}))},e.twrest=function(e,r){r=r||{},r.urlToShare=r.urlToShare||e.attr("href"),ft.utl.openWindow(r.urlToShare,"twitter",500,360),Fiverr.sendSharingToDoCompleted()},e.gplus=function(e,r){r=r||{},r.urlToShare=r.urlToShare||e.attr("href"),ft.utl.openWindow(r.urlToShare,"googleplus",500,360),Fiverr.sendSharingToDoCompleted()},e.ln=function(e,r,t){r=r||{},t=t||{},"undefined"!=typeof IN&&"undefined"!=typeof IN.UI&&e&&IN.UI.Share().params({url:r.urlToShare||e.attr("href"),success:function(e){t.onShareClickCallback?t.onShareClickCallback(e):Fiverr.sendSharingToDoCompleted()}}).place(document.body)}}};window.fOrderShareDeliveries=r}(jQuery);